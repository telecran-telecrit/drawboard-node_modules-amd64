{"ast":null,"code":"import { lineLength } from '../geometry';\nimport { polygonHachureLines } from './scan-line-hachure';\nexport class DotFiller {\n  constructor(helper) {\n    this.helper = helper;\n  }\n\n  fillPolygon(points, o) {\n    o = Object.assign({}, o, {\n      curveStepCount: 4,\n      hachureAngle: 0,\n      roughness: 1\n    });\n    const lines = polygonHachureLines(points, o);\n    return this.dotsOnLines(lines, o);\n  }\n\n  dotsOnLines(lines, o) {\n    let ops = [];\n    let gap = o.hachureGap;\n\n    if (gap < 0) {\n      gap = o.strokeWidth * 4;\n    }\n\n    gap = Math.max(gap, 0.1);\n    let fweight = o.fillWeight;\n\n    if (fweight < 0) {\n      fweight = o.strokeWidth / 2;\n    }\n\n    for (const line of lines) {\n      const length = lineLength(line);\n      const dl = length / gap;\n      const count = Math.ceil(dl) - 1;\n      const alpha = Math.atan((line[1][1] - line[0][1]) / (line[1][0] - line[0][0]));\n\n      for (let i = 0; i < count; i++) {\n        const l = gap * (i + 1);\n        const dy = l * Math.sin(alpha);\n        const dx = l * Math.cos(alpha);\n        const c = [line[0][0] - dx, line[0][1] + dy];\n        const cx = this.helper.randOffsetWithRange(c[0] - gap / 4, c[0] + gap / 4, o);\n        const cy = this.helper.randOffsetWithRange(c[1] - gap / 4, c[1] + gap / 4, o);\n        const el = this.helper.ellipse(cx, cy, fweight, fweight, o);\n        ops = ops.concat(el.ops);\n      }\n    }\n\n    return {\n      type: 'fillSketch',\n      ops\n    };\n  }\n\n}","map":{"version":3,"sources":["/home/pro/Solutions/drawboard-light/node_modules/roughjs/bin/fillers/dot-filler.js"],"names":["lineLength","polygonHachureLines","DotFiller","constructor","helper","fillPolygon","points","o","Object","assign","curveStepCount","hachureAngle","roughness","lines","dotsOnLines","ops","gap","hachureGap","strokeWidth","Math","max","fweight","fillWeight","line","length","dl","count","ceil","alpha","atan","i","l","dy","sin","dx","cos","c","cx","randOffsetWithRange","cy","el","ellipse","concat","type"],"mappings":"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","sourcesContent":["import { lineLength } from '../geometry';\nimport { polygonHachureLines } from './scan-line-hachure';\nexport class DotFiller {\n    constructor(helper) {\n        this.helper = helper;\n    }\n    fillPolygon(points, o) {\n        o = Object.assign({}, o, { curveStepCount: 4, hachureAngle: 0, roughness: 1 });\n        const lines = polygonHachureLines(points, o);\n        return this.dotsOnLines(lines, o);\n    }\n    dotsOnLines(lines, o) {\n        let ops = [];\n        let gap = o.hachureGap;\n        if (gap < 0) {\n            gap = o.strokeWidth * 4;\n        }\n        gap = Math.max(gap, 0.1);\n        let fweight = o.fillWeight;\n        if (fweight < 0) {\n            fweight = o.strokeWidth / 2;\n        }\n        for (const line of lines) {\n            const length = lineLength(line);\n            const dl = length / gap;\n            const count = Math.ceil(dl) - 1;\n            const alpha = Math.atan((line[1][1] - line[0][1]) / (line[1][0] - line[0][0]));\n            for (let i = 0; i < count; i++) {\n                const l = gap * (i + 1);\n                const dy = l * Math.sin(alpha);\n                const dx = l * Math.cos(alpha);\n                const c = [line[0][0] - dx, line[0][1] + dy];\n                const cx = this.helper.randOffsetWithRange(c[0] - gap / 4, c[0] + gap / 4, o);\n                const cy = this.helper.randOffsetWithRange(c[1] - gap / 4, c[1] + gap / 4, o);\n                const el = this.helper.ellipse(cx, cy, fweight, fweight, o);\n                ops = ops.concat(el.ops);\n            }\n        }\n        return { type: 'fillSketch', ops };\n    }\n}\n"]},"metadata":{},"sourceType":"module"}